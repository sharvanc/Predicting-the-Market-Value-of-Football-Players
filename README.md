# Predicting the Market Value of Football Players with Regression

The market value of a football player is the estimate of the amount his football club can sell or transfer his contract to another club. And football clubs can pay huge amount to obtain the top players. As we can see later, market values of football players follow an exponential trend, indicating that the a small subset of players are highly valuable. Hence, the ability to predict market values may offer a commercial advantage to some of these rich football clubs and whether a player is overpriced comparing with the values of similar players when negotiating with another club to acquire a player. 

Following are some of the most important factors that drive market value of a player:

* Footballing Skills: As no football players are 100% versatile, footballing skills are categorized into several domains such as Defending, Shooting and Goalkeeping. And having high ratings in any one of these domains can raise your market value.
* On-Field Position: On average, strikers are valued more than midfielders, followed by defenders.
* Age: Or how  young is the player. Naturally, younger players will command higher market value, as they have greater potential for growth and can have longer service terms.
* Media Coverage: Or the Media Coefficient. Generally, having popular players, who make a greater media impact, can generate more revenue for the clubs and can cost a lot more.

Since some of the data on these factors are difficult to obtain, I will attempt to create a viable regression model to predict market value based on only footballing skills and age.


## Getting the Data:

The data can be scraped from the FIFA INDEX website with libarires like BeautifulSoup. Here I used a similarly prepared data from <a href= 'https://github.com/tanpengshi/'> Tan Pengshi Alvin </a>, Huge thanks to him. In total, the data was collected from the website of 19,401 players, which includes their height, weight, age, preferred foot and skill ratings. Each skill rating are sub-categorized into domains, which are scored from 0–100. The skill ratings are therefore generated by taking the mean of their domains.

## The Exploratory Data Analysis:

After plotting the heatmap of features and target (Market Value) revealed some interesting trends: Height, Weight, Age, Preferred Foot and Goalkeeping seems to be uncorrelated with the target variable. We already understand from domain knowledge that age is an important predictor of Market Value, and Goalkeeping is negatively correlated with other skill metrics. This is not surprising as goalkeepers are mostly specialized, and are seldom playing on field. However, some of these goalkeepers are highly value(Like Allison Becker or Liverpool and Kepa Arrizabalaga of Chelsea FC). 

## Feature Selection and Engineering:

Took the logarithm of the Market Value in an attempt to linearize the data. Furthermore, the features Height, Weight and Preferred Foot are dropped. It lead to the drastic improvement of the model.

Not to mention that the Adjusted R² values improved from 0.32 to 0.67, the Log-Likelihood also increases, demonstrating better goodness of fit. Furthermore, the residuals follow a much more normal distribution with the Skew reducing to almost 0 and Kurtosis reducing to almost 3, fulfilling the normality assumption. In addition, the correlation with the target variable improved hugely across the features.
Other insights that we can observe from the OLS summaries are the negative coefficients of the Age and Passing features. While we already know that Age is inversely correlated with Market Value, the negative coefficient for Passing comes as a surprise. This means that if a player improves his Passing skills, on average, his Market Value will fall consequently! A possible explanation is that the market rewards more dominant players, and players who are better at passing might be weaker in other areas.

## Model Selection:

Now, to fit the data, the regression models that we wish to compare are Simple Linear Regression, LASSO Regression, Ridge Regression, Elastic Net Regression and Polynomial Regression. Note that LASSO, Ridge and Elastic Net are simply regularized versions of the Linear Regression that imposed additional regularized terms to the cost function that we want to minimize. Each of these regularized terms contain an hyper-parameter Alpha with a value that is chosen during model selection. Before proceeding, we randomly split the entire data frame into 80% Training Set and 20% Test set, where we hold out the Test Set for final model evaluation. For model selection, we further randomly split the Training Set into 5-Folds for cross-validation.

By taking mean scores (Mean Absolute Error) on the validation set in the 5-Fold CV, the optimal Alphas are selected for LASSO, Ridge and Elastic Net. The optimal degree is also chosen for Polynomial Regression. The optimal Alphas and degree are therefore:

* LASSO Regression: Approx. 0
* Ridge Regression: 0.93
* Elastic Net Regression: Approx. 0
* Polynomial Regression: Degree 4

Because the Alpha values for LASSO and Elastic Net are negligible, they can be approximated as the Linear Regression model. Comparing the performance of the remaining models, it is clear that Polynomial Regression (Degree 4) is the winner.


## Model Evaluation:

Upon scoring the test set on Log Market Value, the results are very comparable still with r² of 0.930, Mean Absolute Error of 0.279, although the Kurtosis is around 1. The Q-Q plot is also pretty linear, representing a good model fit on the data. However, before we get too happy with the results, we should be reminded that we have taken logarithm of the target variable earlier. What happens when we “un-log” our predicted target variable and compare with the original market value in the Test Set? Scoring the test set on Market Value, without taking logarithm, we receive a r² of 0.836, Mean Absolute Error of € 668,684, and a Kurtosis of 234! The results are surprising, however I should highlight that this is the best model we could possibly achieve with regression and the limited features that we chose.

While the predictions generally follow the trend of the actual Market Value, we are able to observe some outliers. In addition, the model also appear to favor Defenders, as evidenced by placing Virgil van Dijk and Giorgio Chiellini in the top 5 rows, probably due to the recent big money transfers of Harry Maguire and Ruben Dias. A more accurate model would have favored Strikers instead.


## Conclusion:

Nonetheless, the results of the finalized model is rather respectable given the limited features that I used. In the future, should other data sources be available, important features such as on-field position of players and media coefficient should be considered.
